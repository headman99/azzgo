<cfe-header [showBackBtn]="false" [title]="'Messaggi'"></cfe-header>

  <ion-content color="mainColor" style="overflow: hidden;height: -webkit-fill-available;">
    <ion-list style="border-top-left-radius: 20px; border-top-right-radius: 20px; overflow: auto; height: 97%; margin-left: 16px; margin-right: 16px; -webkit-margin-top-collapse: separate; margin-top: 16px;">
      <div *ngFor="let user of userListArray">
        <div *ngIf="user">
          <ion-row style="height: max-content;">
            <ion-col col-12 col-md-6 col-lg-4>
              <ion-item class="user" (click)="tappedOnItems($event, user.conversationWith)">
                <ion-avatar slot="start">
                  <img [src]="user.conversationWith.avatar" />
                </ion-avatar>
                <ion-row style="width: 100%">
                
                  <ion-col style="max-width: max-content">
                
                  </ion-col>
                  <ion-col style="width: max-content">
                    <ion-row>
                        <span>
                          {{user.conversationWith.name}}
                        </span>
                        <span *ngIf="user.blockedByMe" style="color: red; line-height: 22px; font-size: 14px; font-weight: bold;">
                          blocked
                        </span>
                    </ion-row>
                    <ion-row>
                      <span style="line-height: 22px; font-size: 14px; color: #9E9E9E;">
                        {{user.conversationWith.status}}
                      </span>
                    </ion-row>
                  </ion-col>
                  <ion-col style="max-width: 24px; padding: 0px; margin-left: 10%;">
                    <span *ngIf="user.unreadMessageCount > 0" style="border-radius: 50%;width: 24px;height: 24px;padding-top: 6px;background-color: red;color: #fff;text-align: center;font-size: 12px; display: flex; justify-content: center; margin-top: 6px; position:absolute; right: 0px;">
                      {{user.unreadMessageCount}}
                    </span>
                  </ion-col>
                  <ion-col style="max-width: 24px; padding: 0px; margin-left: 10%; margin-top: 2%;" (click)="presentActionSheet($event, user)">
                    <ion-icon name="more" style="width: 24px; height: 24px;"></ion-icon>
                  </ion-col>
                </ion-row>
              </ion-item>
            </ion-col>
          </ion-row>
        </div>
      </div>
      <ion-item lines="none" (click)="loadNextUsers($event)" class="loadButton">
        <button style="margin: auto; background: white; border: 1px solid gray; padding: 5px;">
          Carica conversazioni precedenti
        </button>
      </ion-item>
    </ion-list>
  </ion-content>